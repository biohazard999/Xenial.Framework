using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

using DevExpress.ExpressApp.DC;
using DevExpress.ExpressApp.Model;

using Xenial.Framework.Layouts;

namespace Xenial.Framework.Model
{
    /// <summary>
    /// Interface IModelGeneratedView
    /// </summary>
    /// <autogeneratedoc />
    public interface IModelGeneratedDetailView
    {
        /// <summary>
        /// Gets the type of the generator.
        /// </summary>
        /// <value>The type of the generator.</value>
        /// <autogeneratedoc />
        Type? DetailViewLayoutGeneratorType { get; }

        /// <summary>
        /// Gets the name of the build layout method.
        /// </summary>
        /// <value>The name of the build layout method.</value>
        /// <autogeneratedoc />
        string? BuildLayoutMethodName { get; }
    }

    /// <summary>
    /// Class ModelGeneratedViewDomainLogic.
    /// </summary>
    /// <autogeneratedoc />
#pragma warning disable CA1707 //By convention
    [DomainLogic(typeof(IModelGeneratedDetailView))]
    public static class ModelGeneratedDetailViewDomainLogic
    {
        /// <summary>
        /// Gets the type of the generator.
        /// </summary>
        /// <param name="modelView">The model view.</param>
        /// <returns>System.Nullable&lt;Type&gt;.</returns>
        /// <autogeneratedoc />
        public static Type? Get_DetailViewLayoutGeneratorType(IModelGeneratedDetailView modelView)
        {
            _ = modelView ?? throw new ArgumentNullException(nameof(modelView));

            if (modelView is IModelDetailView detailView)
            {
                if (detailView.ModelClass == null)
                {
                    return null;
                }
                var attributes = detailView.ModelClass.TypeInfo.FindAttributes<DetailViewLayoutBuilderAttribute>();
                var attribute = attributes.FirstOrDefault(); //TODO: Multiple DetailViews
                return attribute?.GeneratorType;
            }

            return null;
        }
    }
#pragma warning restore CA1707
}
