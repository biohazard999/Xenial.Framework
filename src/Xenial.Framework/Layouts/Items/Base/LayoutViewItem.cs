using System;

using DevExpress.ExpressApp.Model;
using DevExpress.Utils;

using Xenial;
using Xenial.Framework.Layouts.Items.LeafNodes;

#pragma warning disable CS1591 // Missing XML comment for publicly visible type or member
#pragma warning disable IDE1006 // Naming Styles

namespace Xenial.Framework.Layouts.Items.Base;

/// <summary>   (Immutable) a layout view item. </summary>
[XenialCheckLicense]
[XenialModelOptions(
    typeof(IModelViewItem), IgnoredMembers = new[]
    {
        nameof(IModelViewItem.Id),
        nameof(IModelViewItem.Index),
        nameof(IModelViewItem.Caption)
    }
)]
[XenialModelOptions(
    typeof(IModelLayoutViewItem), IgnoredMembers = new[]
    {
        nameof(IModelLayoutViewItem.Id),
        nameof(IModelLayoutViewItem.Index),
        nameof(IModelLayoutViewItem.ViewItem)
    }
)]
public abstract partial record LayoutViewItem : LayoutItemLeaf
{
    //   public Action<IModelViewItem>? ViewItemOptions { get; set; }

    public string ViewItemId { get; init; }

    /// <summary>
    /// Initializes a new instance of the <see cref="LayoutPropertyEditorItem"/> class.
    /// </summary>
    /// <param name="viewItemId">The property editor.</param>
    /// <autogeneratedoc />
    protected LayoutViewItem(string viewItemId) : this(viewItemId, viewItemId) { }

    /// <summary>
    /// Initializes a new instance of the <see cref="LayoutPropertyEditorItem"/> class.
    /// </summary>
    /// <param name="viewItemId">The property editor.</param>
    /// <param name="id">The id.</param>
    /// <autogeneratedoc />
    protected LayoutViewItem(string viewItemId, string id)
        => (ViewItemId, Id) = (Slugifier.GenerateSlug(viewItemId), Slugifier.GenerateSlug(id));

    private string? caption;

    internal bool WasCaptionSet { get; set; }

    /// <summary>
    /// Specifies the caption of the current View Item.
    /// </summary>
    public string? Caption
    {
        get => caption;
        set
        {
            WasCaptionSet = true;
            caption = value;
        }
    }
}
