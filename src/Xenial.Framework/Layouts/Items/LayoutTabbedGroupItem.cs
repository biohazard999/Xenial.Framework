using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;

using DevExpress.ExpressApp.Layout;
using DevExpress.ExpressApp.Model;
using DevExpress.Persistent.Base;
using DevExpress.Utils;

using Xenial.Framework.Layouts.Items.Base;
using Xenial.Framework.Layouts.Items.PubTernal;

using Locations = DevExpress.Persistent.Base.Locations;
using ToolTipIconType = DevExpress.Persistent.Base.ToolTipIconType;

#pragma warning disable CA1710 //Rename Type to end in Collection -> By Design
#pragma warning disable CA2227 //Collection fields should not have a setter: By Design

namespace Xenial.Framework.Layouts.Items
{
    /// <summary>
    /// 
    /// </summary>
    [XenialCheckLicence]
    public partial record LayoutTabbedGroupItem
        : LayoutItemNode,
        ICollection<LayoutTabGroupItem>,
        IEnumerable<LayoutTabGroupItem>,
        ILayoutElementWithCaption,
        ILayoutElementWithCaptionOptions
    {
        /// <summary>
        /// Creates this instance.
        /// </summary>
        /// <returns>Xenial.Framework.Layouts.Items.LayoutTabbedGroupItem.</returns>
        /// <autogeneratedoc />
        public static LayoutTabbedGroupItem Create()
            => new();

        /// <summary>
        /// Creates the specified identifier.
        /// </summary>
        /// <param name="id">The identifier.</param>
        /// <returns>Xenial.Framework.Layouts.Items.LayoutTabbedGroupItem.</returns>
        /// <autogeneratedoc />
        public static LayoutTabbedGroupItem Create(string id)
            => new(id);

        /// <summary>
        /// Initializes a new instance of the <see cref="LayoutTabbedGroupItem"/> class.
        /// </summary>
        /// <autogeneratedoc />
        public LayoutTabbedGroupItem() { }

        /// <summary>
        /// Initializes a new instance of the <see cref="LayoutTabbedGroupItem"/> class.
        /// </summary>
        /// <param name="id">The identifier.</param>
        /// <autogeneratedoc />
        public LayoutTabbedGroupItem(string id)
            => Id = Slugifier.GenerateSlug(id);

        /// <summary>
        /// Gets the is leaf.
        /// </summary>
        /// <value>The is leaf.</value>
        /// <autogeneratedoc />
        internal override bool IsLeaf => false;

        /// <summary>
        /// Gets the children.
        /// </summary>
        /// <value>The children.</value>
        /// <autogeneratedoc />
        internal protected LinkedList<LayoutTabGroupItem> ChildNodes { get; internal set; } = new();

        /// <summary>
        /// Gets the children.
        /// </summary>
        /// <value>The children.</value>
        /// <autogeneratedoc />
        public virtual ICollection<LayoutTabGroupItem> Children => ChildNodes;

        /// <summary>
        /// Gets the count.
        /// </summary>
        /// <value>The count.</value>
        /// <autogeneratedoc />
        public int Count => ChildNodes.Count;

        /// <summary>
        /// Gets the is read only.
        /// </summary>
        /// <value>The is read only.</value>
        /// <autogeneratedoc />
        [EditorBrowsable(EditorBrowsableState.Never)]
        public bool IsReadOnly => false;

        /// <summary>
        /// Adds the specified node.
        /// </summary>
        /// <param name="item">The node.</param>
        /// <autogeneratedoc />
        public void Add(LayoutTabGroupItem item)
        {
            _ = item ?? throw new ArgumentNullException(nameof(item));

            if (!Equals(item.Parent))
            {
                item.Parent = this;
            }
            if (!ChildNodes.Contains(item))
            {
                ChildNodes.AddLast(item);
            }
        }

        /// <summary>
        /// Adds the specified items.
        /// </summary>
        /// <param name="items">The items.</param>
        /// <autogeneratedoc />
        public void Add(params LayoutTabGroupItem[] items)
        {
            foreach (var item in items)
            {
                Add(item);
            }
        }

        /// <summary>
        /// Removes the specified node.
        /// </summary>
        /// <param name="item">The node.</param>
        /// <autogeneratedoc />
        public bool Remove(LayoutTabGroupItem item)
        {
            _ = item ?? throw new ArgumentNullException(nameof(item));

            if (ChildNodes.Contains(item))
            {
                var value = ChildNodes.Remove(item);
                item.Parent = null;
                return value;
            }
            return false;
        }

        /// <summary>
        /// Gets the enumerator.
        /// </summary>
        /// <returns>System.Collections.Generic.IEnumerator&lt;Xenial.Framework.Layouts.Items.Base.LayoutItemNode&gt;.</returns>
        /// <autogeneratedoc />
        public IEnumerator<LayoutTabGroupItem> GetEnumerator() => ChildNodes.GetEnumerator();

        IEnumerator IEnumerable.GetEnumerator() => GetEnumerator();

        /// <summary>
        /// Clears this instance.
        /// </summary>
        /// <autogeneratedoc />
        public void Clear()
        {
            while (ChildNodes.Count > 0
                && ChildNodes.First?.Value is LayoutTabGroupItem itemNode
            )
            {
                itemNode.ParentItem = null;
                ChildNodes.Remove(itemNode);
            }
        }

        /// <summary>
        /// Determines whether this instance contains the object.
        /// </summary>
        /// <param name="item">The node.</param>
        /// <returns>bool.</returns>
        /// <autogeneratedoc />
        public bool Contains(LayoutTabGroupItem item)
        {
            _ = item ?? throw new ArgumentNullException(nameof(item));
            return ChildNodes.Contains(item);
        }

        /// <summary>
        /// Copies to.
        /// </summary>
        /// <param name="array">The array.</param>
        /// <param name="arrayIndex">Index of the array.</param>
        /// <autogeneratedoc />
        public void CopyTo(LayoutTabGroupItem[] array, int arrayIndex)
            => throw new NotImplementedException();

        /// <summary>
        /// Gets or sets the direction.
        /// </summary>
        /// <value>The direction.</value>
        /// <autogeneratedoc />
        public FlowDirection Direction { get; init; }

        /// <summary>
        /// Gets or sets the caption.
        /// </summary>
        /// <value>The caption.</value>
        /// <autogeneratedoc />
        public string? Caption { get; set; }

        /// <summary>
        /// Gets or sets the show caption.
        /// </summary>
        /// <value>The show caption.</value>
        /// <autogeneratedoc />
        public bool? ShowCaption { get; set; }

        /// <summary>
        /// Gets or sets the caption horizontal alignment.
        /// </summary>
        /// <value>The caption horizontal align.</value>
        /// <autogeneratedoc />
        public HorzAlignment? CaptionHorizontalAlignment { get; set; }

        /// <summary>
        /// Gets or sets the caption location.
        /// </summary>
        /// <value>The caption location.</value>
        /// <autogeneratedoc />
        public Locations? CaptionLocation { get; set; }

        /// <summary>
        /// Gets or sets the caption vertical alignment.
        /// </summary>
        /// <value>The caption vertical align.</value>
        /// <autogeneratedoc />
        public VertAlignment? CaptionVerticalAlignment { get; set; }

        /// <summary>
        /// Gets or sets the caption word wrap.
        /// </summary>
        /// <value>The caption word wrap.</value>
        /// <autogeneratedoc />
        public WordWrap? CaptionWordWrap { get; set; }

        /// <summary>
        /// Gets or sets the multi line.
        /// </summary>
        /// <value>The multi line.</value>
        /// <autogeneratedoc />
        public bool? MultiLine { get; set; }

        /// <summary>
        /// Gets or sets the tabbed group options.
        /// </summary>
        /// <value>The tabbed group options.</value>
        /// <autogeneratedoc />
        public Action<IModelTabbedGroup>? TabbedGroupOptions { get; set; }
    }
}
