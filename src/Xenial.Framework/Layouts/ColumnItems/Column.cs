#pragma warning disable CS1591 // Missing XML comment for publicly visible type or member
#pragma warning disable CA1000 // Don't declare static members in generic types
#pragma warning disable IDE1006 // Naming Styles

using System;
using System.ComponentModel;
using System.Linq.Expressions;

using DevExpress.ExpressApp.Model;

using Xenial.Framework.Utils.Slugger;

namespace Xenial.Framework.Layouts.ColumnItems;

/// <summary>   (Immutable) a column. </summary>
[XenialCheckLicense]
[XenialModelOptions(typeof(IModelColumn))]
public partial record Column
{
    /// <summary>
    /// 
    /// </summary>
    /// <param name="propertyName"></param>
    /// <returns></returns>
    public static Column Create(string propertyName) => new(propertyName);

    private static SlugifierConfig CreateDefaultSlugifierConfig() => new()
    {
        CollapseWhiteSpace = true,
        CollapseDashes = true,
        ForceLowerCase = false,
        TrimWhitespace = true,
        StringReplacements =
        {
            ["."] = ".",
            [" "] = "-",
            ["/"] = "-",
            ["\\"] = "-",
        }
    };

    private static Slugifier defaultSlugifier = new(CreateDefaultSlugifierConfig());

    /// <summary>
    /// Gets or sets the default slugifier.
    /// </summary>
    /// <value>The default slugifier.</value>
    /// <exception cref="ArgumentNullException">defaultSlugifier</exception>
    /// <autogeneratedoc />
    [EditorBrowsable(EditorBrowsableState.Never)]
    internal Slugifier Slugifier { get; init; } = DefaultSlugifier ?? new(CreateDefaultSlugifierConfig());

    /// <summary>
    /// Gets or sets the default slugifier.
    /// </summary>
    /// <value>The default slugifier.</value>
    /// <exception cref="ArgumentNullException">defaultSlugifier</exception>
    /// <autogeneratedoc />
    [EditorBrowsable(EditorBrowsableState.Never)]
    public static Slugifier DefaultSlugifier
    {
        get => defaultSlugifier;
        set => defaultSlugifier = value ?? throw new ArgumentNullException(nameof(DefaultSlugifier));
    }

    /// <summary>
    /// Initializes a new instance of the <see cref="Column"/> class.
    /// </summary>
    /// <param name="propertyName">Name of the property.</param>
    /// <autogeneratedoc />
    public Column(string propertyName)
        => (PropertyName, Id) = (propertyName, Slugifier.GenerateSlug(propertyName));
}
